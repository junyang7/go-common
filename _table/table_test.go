package _table

import (
	"github.com/junyang7/go-common/_directory"
	"testing"
)

func Test_Build(t *testing.T) {
	path := _directory.Current() + "/table"
	if !_directory.Exists(path) {
		_directory.Create(path)
	}
	showCreateTable := "CREATE TABLE `sub_order` (\n  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n  `sub_order_id` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT '子订单ID',\n  `order_id` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT '主订单ID',\n  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '有效性，0无效，1有效',\n  `addtime` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '订单新建时间',\n  `modtime` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' ON UPDATE CURRENT_TIMESTAMP COMMENT '订单修改时间',\n  `deltime` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '订单删除时间',\n  `expire_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '订单失效时间',\n  `cancel_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '订单取消时间',\n  `delivery_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '订单发货时间',\n  `finish_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '订单完成时间',\n  `close_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '订单关闭时间',\n  `pay_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '订单支付时间',\n  `is_cross_border` enum('Y','N') NOT NULL DEFAULT 'N' COMMENT '订单是否包含跨境商品，Y是，N否，默认N',\n  `price` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '订单总金额(不含运费)',\n  `cost_price` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '订单总成本金额',\n  `income` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '订单总收益金额',\n  `sku_count` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '订单总sku数量',\n  `express_cost` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '订单快递费用',\n  `source` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '订单来源：1.管理后台巨鲸帮帮;2.管理后台微博小店;3.达人Andorid应用端;4.达人iOS应用端;5.达人微博轻应用端;6.粉丝微信小程序端;',\n  `state_code` int(4) unsigned NOT NULL DEFAULT '1001' COMMENT '订单流转状态码',\n  `sold_state_code` int(4) unsigned NOT NULL DEFAULT '0',\n  `has_gift` tinyint(1) unsigned NOT NULL DEFAULT '5' COMMENT '是否包含赠品:5.不包含;6.包含；原含义：额度支付类型，1无，2微博额度，3巨鲸帮帮额度(2024-11-26)',\n  `pay_balance` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '使用的授信额度',\n  `pay_grant_balance` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '使用的赠送额度',\n  `pay_price` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '实际支付金额(不含运费)',\n  `pay_type` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '支付类型：1.无平台;2.余额支付;3.微信APP支付;4.支付宝APP支付;5.微博支付;',\n  `pay_state` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '支付状态：1.未支付;2.支付成功;3.支付失败;',\n  `shop_settlement_state` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '达人佣金结算状态：默认 0 未结算， 1已结算',\n  `shop_settlement_datetime` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '达人拥金结算时间',\n  `bill_check_state` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '对账状态，0未对账，1已对账，默认0',\n  `bill_check_datetime` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '对账时间',\n  `is_pay_for_platform` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '是否结算给平台（仅样品订单）,0 不结算，1结算， 默认 0',\n  `is_pay_for_platform_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '结算给平台时间',\n  `expected_after_sale_end_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '预期售后结束时间',\n  `actual_after_sale_end_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '实际售后结束时间【初始为预期时间】',\n  `finance_statistic_sale_status` tinyint(2) NOT NULL DEFAULT '0' COMMENT '【财务统计使用】售后状态：0 默认， 1售后中， 2售后结束',\n  `payment_platform_order` varchar(255) NOT NULL DEFAULT '' COMMENT '支付平台生成订单',\n  `name` varchar(255) NOT NULL DEFAULT '' COMMENT '买家联系人姓名',\n  `phone` varchar(255) NOT NULL DEFAULT '' COMMENT '买家联系人手机号码',\n  `region` varchar(255) NOT NULL DEFAULT '' COMMENT '买家收货地址区域',\n  `address` varchar(255) NOT NULL DEFAULT '' COMMENT '买家收货详细地址',\n  `real_name` varchar(255) NOT NULL DEFAULT '' COMMENT '买家收货人真实姓名（跨境用）',\n  `id_card` varchar(255) NOT NULL DEFAULT '' COMMENT '买家收货人真实身份证号码（跨境用）',\n  `has_sku_in_sold` enum('Y','N') NOT NULL DEFAULT 'N' COMMENT '当前子订单中是否存在售后中的商品',\n  `exists_express` enum('N','Y') NOT NULL DEFAULT 'N' COMMENT '是否存在物流（包含假物流），Y是，N否，默认N',\n  `exists_not_delivered_sku` enum('Y','N') NOT NULL DEFAULT 'Y' COMMENT '是否存在未发货商品，Y是，N否，默认Y',\n  `remark` varchar(255) NOT NULL DEFAULT '' COMMENT '备注，关闭订单时的原因，旧的微博项目使用',\n  `is_shop_message_pushed` enum('N','Y') NOT NULL DEFAULT 'N' COMMENT '店铺通知消息是否已经添加到任务，N否，Y是，默认N',\n  `has_sku_in_ticket` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '是否有商品存在工单流程中：默认0，0无工单，1工单中，2工单关闭',\n  `cps_fee` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '子订单总佣金金额',\n  `prime_price` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '订单总包邮包税价金额',\n  `order_total_price` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '子订单合计总金额(含运费)',\n  `order_total_pay_price` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '子订单合计支付总金额(含运费)',\n  `buyer_id` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT '买家ID',\n  `seller_id` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT '卖家ID',\n  `seller_weibo_id` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT '卖家微博UID',\n  `shop_id` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '店铺ID',\n  `shop_type` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '店铺类型：1.达人店铺;2.零售商店铺',\n  `merchant_id` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT '供应商ID',\n  `type` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '订单类型（标记）：1.样品订单;2.销售订单;3.闪购定向订单;4.商家日常订单;5.商家全量闪购订单;6.0元购订单;7.医美订单\t;8.虚拟类目订单',\n  `type_filter` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '订单类型（分组）：1.达人店铺订单;2.商家店铺订单;3.样品订单',\n  `remarks` varchar(255) NOT NULL DEFAULT '' COMMENT '订单备注',\n  `sold_success_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '子订单最近一次售后退款成功时间',\n  `sold_refund_amount` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '子订单累计退款金额',\n  `has_refunded_money` enum('N','Y') NOT NULL DEFAULT 'N' COMMENT '是否有退款：N否，Y是，默认N',\n  `success_refund_info` varchar(1000) NOT NULL DEFAULT '' COMMENT '成功退款信息',\n  `success_refund_type` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '成功退款类型：1系统退款+工单退款；2系统退款；3工单退款',\n  `retailer_remark` varchar(300) NOT NULL DEFAULT '' COMMENT '商家备注',\n  `merchant_remark` varchar(1000) NOT NULL DEFAULT '' COMMENT '供应商备注',\n  `is_effected` enum('N','Y') NOT NULL DEFAULT 'N' COMMENT '是否是有效订单：Y是，N否，默认N',\n  `settle_type` tinyint(2) NOT NULL DEFAULT '1' COMMENT '结算类型:1巨鲸帮帮; 2微博钱包',\n  `coupon_amount` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '子订单商品优惠金额',\n  `hbfq_num` tinyint(2) unsigned NOT NULL DEFAULT '0' COMMENT '花呗分期期数',\n  `has_comment` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '是否评论',\n  `comment_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '评论时间',\n  `recharge_account` varchar(255) NOT NULL DEFAULT '' COMMENT '收货人充值账号',\n  `recharge_account_type` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '1手机号码；2QQ账号；3微博昵称；默认0；',\n  `finish_type` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '【已废弃】履约方式：1账号直充；2实物邮寄；3核销码；默认0；',\n  `expect_finish_message` varchar(255) NOT NULL DEFAULT '' COMMENT '【已废弃】预计到账文案',\n  `expect_finish_countdown` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '【已废弃】预计到账时效(从支付到发货的预计秒数)',\n  `expect_finish_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT '预计到账时间',\n  `is_encrypted` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '是否已加密：0未加密；1已加密',\n  `buyer_weibo_id` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT '买家微博ID',\n  `contact_phone` varchar(255) NOT NULL DEFAULT '' COMMENT '联系人手机号码',\n  `change_price` decimal(15,2) NOT NULL DEFAULT '0.00' COMMENT '子订单更改金额',\n  `total_origin_price` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '商品原价总价',\n  `activity_reduce` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '活动优惠总金额',\n  `shop_reduce` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '商家优惠总金额',\n  `platform_reduce` decimal(15,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '平台优惠总金额',\n  `is_merge` tinyint(2) unsigned NOT NULL DEFAULT '2' COMMENT '是否合单支付:1.是;2否',\n  `anchor_reduce` decimal(15,2) NOT NULL DEFAULT '0.00' COMMENT '达人承担金额',\n  `change_express_cost_price` decimal(15,2) NOT NULL DEFAULT '0.00' COMMENT '商家修改运费的差值',\n  PRIMARY KEY (`id`) USING BTREE,\n  UNIQUE KEY `uk_sub_order_id` (`sub_order_id`) USING BTREE,\n  KEY `idx_order_id` (`order_id`) USING BTREE,\n  KEY `idx_buyer_id` (`buyer_id`) USING BTREE,\n  KEY `idx_seller_id` (`seller_id`) USING BTREE,\n  KEY `idx_modtime` (`modtime`),\n  KEY `idx_buyer_weibo_id` (`buyer_weibo_id`),\n  KEY `idx_aft_sale` (`actual_after_sale_end_time`),\n  KEY `idx_addtime` (`addtime`)\n) ENGINE=InnoDB AUTO_INCREMENT=30046801 DEFAULT CHARSET=utf8mb4 COMMENT='子订单表';"
	Build(path, "cmn_order", "sub_order", showCreateTable)
	_directory.Delete(path)
}
func Test_BuildByAuto(t *testing.T) {
	path := _directory.Current() + "/table"
	if !_directory.Exists(path) {
		_directory.Create(path)
	}
	BuildByAuto()
	_directory.Delete(path)
}
